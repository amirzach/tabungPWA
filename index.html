<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="theme-color" content="#4c5760">
  <meta name="description" content="Track your daily savings with this simple app">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  <title>Savings Tracker</title>
  <link rel="manifest" href="manifest.json">
  <link rel="apple-touch-icon" href="icons/icon-192x192.png">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <style>
    :root {
      --primary-color: #3a6ea5;
      --secondary-color: #004e98;
      --accent-color: #ff9a3c;
      --background-color: #f0f8ff;
      --card-color: #ffffff;
      --text-color: #333333;
      --text-light: #777777;
      --success-color: #4caf50;
      --error-color: #f44336;
    }

    * {
      box-sizing: border-box;
      transition: all 0.3s ease;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;
      display: flex;
      justify-content: center;
      align-items: center;
      min-height: 100vh;
      margin: 0;
      background-color: var(--background-color);
      color: var(--text-color);
      padding: 20px;
    }
    
    .container {
      background-color: var(--card-color);
      border-radius: 16px;
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
      padding: 30px;
      width: 100%;
      max-width: 360px;
      text-align: center;
    }

    .app-header {
      display: flex;
      align-items: center;
      justify-content: center;
      margin-bottom: 20px;
    }

    .app-icon {
      background-color: var(--primary-color);
      color: white;
      width: 40px;
      height: 40px;
      border-radius: 10px;
      display: flex;
      align-items: center;
      justify-content: center;
      margin-right: 12px;
      font-size: 18px;
    }

    .app-title {
      font-size: 20px;
      font-weight: 600;
      color: var(--primary-color);
    }
    
    /* Date selector styles */
    .date-container {
      margin-bottom: 25px;
    }

    .date-label {
      font-size: 14px;
      color: var(--text-light);
      margin-bottom: 8px;
      text-align: left;
      display: block;
    }

    .date-selector {
      width: 100%;
      padding: 12px 15px;
      border: 1px solid #e0e0e0;
      border-radius: 8px;
      text-align: left;
      background-color: white;
      position: relative;
      font-size: 14px;
      cursor: pointer;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    
    .date-selector:hover {
      border-color: var(--primary-color);
    }

    .date-selector:focus {
      outline: none;
      border-color: var(--primary-color);
      box-shadow: 0 0 0 2px rgba(58, 110, 165, 0.2);
    }
   
    /* Savings display styles */
    .savings-card {
      background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
      border-radius: 12px;
      padding: 25px 20px;
      color: white;
      margin-bottom: 25px;
      box-shadow: 0 5px 15px rgba(0, 78, 152, 0.3);
    }

    .savings-title {
      font-size: 14px;
      font-weight: 500;
      margin-bottom: 10px;
      opacity: 0.9;
      letter-spacing: 1px;
    }
    
    .savings-amount {
      font-size: 36px;
      font-weight: 700;
      margin-bottom: 5px;
    }

    .streak-info {
      font-size: 13px;
      opacity: 0.8;
      margin-top: 10px;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .streak-info i {
      margin-right: 5px;
      color: var(--accent-color);
    }
    
    .buttons-container {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 12px;
      margin-bottom: 20px;
    }

    .button {
      background-color: var(--primary-color);
      color: white;
      border: none;
      padding: 14px 0;
      border-radius: 8px;
      cursor: pointer;
      font-size: 14px;
      font-weight: 500;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .button i {
      margin-right: 8px;
    }
    
    .button:hover {
      background-color: var(--secondary-color);
      transform: translateY(-2px);
    }

    .button:active {
      transform: translateY(0);
    }

    .secondary-button {
      background-color: transparent;
      color: var(--primary-color);
      border: 1px solid var(--primary-color);
    }

    .secondary-button:hover {
      background-color: rgba(58, 110, 165, 0.1);
    }

    .custom-amount {
      display: flex;
      margin-bottom: 20px;
      gap: 10px;
    }

    .custom-amount input {
      flex: 1;
      padding: 12px;
      border: 1px solid #e0e0e0;
      border-radius: 8px;
      font-size: 14px;
      text-align: center;
    }

    .custom-amount input:focus {
      outline: none;
      border-color: var(--primary-color);
      box-shadow: 0 0 0 2px rgba(58, 110, 165, 0.2);
    }

    .custom-amount button {
      padding: 12px 15px;
      background-color: var(--primary-color);
      color: white;
      border: none;
      border-radius: 8px;
      cursor: pointer;
    }

    .settings-button {
      background: none;
      border: none;
      color: var(--text-light);
      font-size: 20px;
      cursor: pointer;
      padding: 5px;
      margin-left: auto;
    }

    /* History section */
    .history-section {
      margin-top: 25px;
      text-align: left;
    }

    .section-title {
      font-size: 16px;
      font-weight: 600;
      margin-bottom: 15px;
      display: flex;
      align-items: center;
    }

    .section-title i {
      margin-right: 8px;
      color: var(--primary-color);
    }

    .history-list {
      max-height: 150px;
      overflow-y: auto;
      margin-bottom: 15px;
      border-radius: 8px;
      background-color: rgba(240, 240, 255, 0.5);
    }

    .history-item {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 12px 15px;
      border-bottom: 1px solid #f0f0f0;
      font-size: 14px;
    }

    .history-item:last-child {
      border-bottom: none;
    }

    .history-date {
      color: var(--text-light);
      font-size: 13px;
    }

    .history-amount {
      font-weight: 600;
      color: var(--primary-color);
    }

    .history-amount.negative {
      color: var(--error-color);
    }

    /* Toast notification */
    .toast {
      position: fixed;
      bottom: 20px;
      left: 50%;
      transform: translateX(-50%);
      background-color: var(--success-color);
      color: white;
      padding: 12px 20px;
      border-radius: 8px;
      font-size: 14px;
      font-weight: 500;
      box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
      display: flex;
      align-items: center;
      opacity: 0;
      visibility: hidden;
      transition: all 0.3s ease;
    }

    .toast.show {
      opacity: 1;
      visibility: visible;
    }

    .toast.error {
      background-color: var(--error-color);
    }

    .toast i {
      margin-right: 8px;
    }

    /* Offline notification */
    .offline-notification {
      display: none;
      background-color: var(--accent-color);
      color: white;
      padding: 10px;
      border-radius: 8px;
      margin-bottom: 15px;
      font-size: 13px;
      display: flex;
      align-items: center;
    }

    .offline-notification i {
      margin-right: 8px;
    }

    /* Dark mode toggle */
    .dark-mode-toggle {
      position: absolute;
      top: 20px;
      right: 20px;
      background: none;
      border: none;
      color: var(--text-light);
      font-size: 18px;
      cursor: pointer;
      padding: 5px;
    }

    /* Dark mode styles */
    body.dark-mode {
      --background-color: #1a1a2e;
      --card-color: #16213e;
      --text-color: #e6e6e6;
      --text-light: #a0a0a0;
    }

    /* Responsive adjustments */
    @media (max-width: 400px) {
      .container {
        padding: 20px;
      }
      
      .buttons-container {
        grid-template-columns: 1fr;
      }
    }

    /* Animation */
    @keyframes pulse {
      0% { transform: scale(1); }
      50% { transform: scale(1.05); }
      100% { transform: scale(1); }
    }

    .pulse {
      animation: pulse 0.5s ease;
    }
  </style>
</head>

<body>
  <button class="dark-mode-toggle" id="dark-mode-toggle">
    <i class="fas fa-moon"></i>
  </button>

  <div class="container">
    <div class="app-header">
      <div class="app-icon">
        <i class="fas fa-piggy-bank"></i>
      </div>
      <div class="app-title">Savings Tracker</div>
      <button class="settings-button" id="settings-btn">
        <i class="fas fa-cog"></i>
      </button>
    </div>

    <div class="offline-notification" id="offline-msg">
      <i class="fas fa-wifi-slash"></i>
      You're offline. Data will be saved locally.
    </div>
    
    <div class="date-container">
      <label class="date-label">Selected Date</label>
      <div class="date-selector" id="date-selector">
        <span id="selected-date">Today, Apr 2, 2025</span>
        <i class="fas fa-calendar-alt"></i>
      </div>
    </div>
    
    <div class="savings-card">
      <div class="savings-title">TOTAL SAVINGS</div>
      <div class="savings-amount" id="savings-display">RM0</div>
      <div class="streak-info"><i class="fas fa-fire"></i> <span id="streak-count">0 day streak</span></div>
    </div>
    
    <div class="buttons-container">
      <button class="button" id="add-rm1-btn">
        <i class="fas fa-plus"></i> Add RM1
      </button>
      <button class="button secondary-button" id="add-rm5-btn">
        <i class="fas fa-plus"></i> Add RM5
      </button>
    </div>

    <div class="custom-amount">
      <input type="number" id="custom-amount" placeholder="Custom amount" min="1">
      <button id="add-custom-btn"><i class="fas fa-plus"></i></button>
    </div>

    <button class="button secondary-button" id="reset-btn">
      <i class="fas fa-redo-alt"></i> Reset Savings
    </button>

    <div class="history-section">
      <div class="section-title">
        <i class="fas fa-history"></i> Recent Activity
      </div>
      <div class="history-list" id="history-list">
        <!-- History items will be populated here -->
      </div>
    </div>
  </div>

  <div class="toast" id="toast">
    <i class="fas fa-check-circle"></i>
    <span id="toast-message">Savings updated successfully!</span>
  </div>

  <!-- JavaScript -->
  <script>
    document.addEventListener('DOMContentLoaded', function() {
      // Initialize variables
      let savings = localStorage.getItem('savings') ? parseFloat(localStorage.getItem('savings')) : 0;
      let streak = localStorage.getItem('streak') ? parseInt(localStorage.getItem('streak')) : 0;
      let lastSaved = localStorage.getItem('lastSaved') || null;
      let history = localStorage.getItem('history') ? JSON.parse(localStorage.getItem('history')) : [];
      let darkMode = localStorage.getItem('darkMode') === 'true';
      
      // Get DOM elements
      const savingsDisplay = document.getElementById('savings-display');
      const streakCount = document.getElementById('streak-count');
      const addRm1Btn = document.getElementById('add-rm1-btn');
      const addRm5Btn = document.getElementById('add-rm5-btn');
      const addCustomBtn = document.getElementById('add-custom-btn');
      const customAmountInput = document.getElementById('custom-amount');
      const resetBtn = document.getElementById('reset-btn');
      const dateSelector = document.getElementById('date-selector');
      const selectedDate = document.getElementById('selected-date');
      const historyList = document.getElementById('history-list');
      const offlineMsg = document.getElementById('offline-msg');
      const toast = document.getElementById('toast');
      const toastMessage = document.getElementById('toast-message');
      const darkModeToggle = document.getElementById('dark-mode-toggle');
      const settingsBtn = document.getElementById('settings-btn');
      
      // Initialize app state
      if (darkMode) {
        document.body.classList.add('dark-mode');
        darkModeToggle.innerHTML = '<i class="fas fa-sun"></i>';
      }
      
      updateSavings();
      updateStreak();
      updateHistory();
      setCurrentDate();
      
      // Update savings display
      function updateSavings() {
        savingsDisplay.textContent = `RM${savings.toFixed(2)}`;
        savingsDisplay.classList.add('pulse');
        setTimeout(() => {
          savingsDisplay.classList.remove('pulse');
        }, 500);
        localStorage.setItem('savings', savings);
      }
      
      // Update streak
      function updateStreak() {
        const today = new Date().toLocaleDateString();
        
        if (!lastSaved) {
          // First time saving
          streak = 1;
          lastSaved = today;
        } else if (lastSaved !== today) {
          const yesterday = new Date();
          yesterday.setDate(yesterday.getDate() - 1);
          const yesterdayStr = yesterday.toLocaleDateString();
          
          if (lastSaved === yesterdayStr) {
            // Consecutive day
            streak++;
          } else {
            // Streak broken
            streak = 1;
          }
          
          lastSaved = today;
        }
        
        streakCount.textContent = `${streak} day${streak !== 1 ? 's' : ''} streak`;
        localStorage.setItem('streak', streak);
        localStorage.setItem('lastSaved', lastSaved);
      }
      
      // Add to history
      function addToHistory(amount) {
        const now = new Date();
        const historyItem = {
          date: now.toISOString(),
          amount: amount,
          balance: savings
        };
        
        history.unshift(historyItem);
        if (history.length > 50) history.pop(); // Limit history to 50 items
        
        localStorage.setItem('history', JSON.stringify(history));
        updateHistory();
      }
      
      // Update history display
      function updateHistory() {
        historyList.innerHTML = '';
        
        if (history.length === 0) {
          historyList.innerHTML = '<div class="history-item">No activity yet</div>';
          return;
        }
        
        history.forEach(item => {
          const date = new Date(item.date);
          const formattedDate = date.toLocaleDateString('en-US', { 
            month: 'short', 
            day: 'numeric', 
            hour: '2-digit', 
            minute: '2-digit' 
          });
          
          const historyItem = document.createElement('div');
          historyItem.className = 'history-item';
          
          const amountClass = item.amount < 0 ? 'history-amount negative' : 'history-amount';
          const amountPrefix = item.amount < 0 ? '' : '+';
          
          historyItem.innerHTML = `
            <span class="history-date">${formattedDate}</span>
            <span class="${amountClass}">${amountPrefix}RM${item.amount.toFixed(2)}</span>
          `;
          
          historyList.appendChild(historyItem);
        });
      }
      
      // Set current date
      function setCurrentDate() {
        const now = new Date();
        const options = { weekday: 'short', month: 'short', day: 'numeric', year: 'numeric' };
        selectedDate.textContent = now.toLocaleDateString('en-US', options);
      }
      
      // Show toast notification
      function showToast(message, isError = false) {
        toastMessage.textContent = message;
        toast.className = isError ? 'toast error show' : 'toast show';
        
        setTimeout(() => {
          toast.className = toast.className.replace('show', '');
        }, 3000);
      }
      
      // Add RM1 to savings
      addRm1Btn.addEventListener('click', function() {
        addSavings(1);
      });
      
      // Add RM5 to savings
      addRm5Btn.addEventListener('click', function() {
        addSavings(5);
      });
      
      // Add custom amount
      addCustomBtn.addEventListener('click', function() {
        const amount = parseFloat(customAmountInput.value);
        if (isNaN(amount) || amount <= 0) {
          showToast('Please enter a valid amount', true);
          return;
        }
        
        addSavings(amount);
        customAmountInput.value = '';
      });
      
      // Enter key for custom amount
      customAmountInput.addEventListener('keypress', function(e) {
        if (e.key === 'Enter') {
          addCustomBtn.click();
        }
      });
      
      // Common function to add savings
      function addSavings(amount) {
        savings += amount;
        updateSavings();
        updateStreak();
        addToHistory(amount);
        showToast(`RM${amount.toFixed(2)} added to your savings!`);
      }
      
      // Reset savings to 0
      resetBtn.addEventListener('click', function() {
        if (savings > 0) {
          if (confirm('Are you sure you want to reset your savings?')) {
            const oldAmount = savings;
            savings = 0;
            updateSavings();
            addToHistory(-oldAmount);
            showToast('Savings reset to RM0');
          }
        } else {
          showToast('No savings to reset', true);
        }
      });
      
      // Date selector functionality
      dateSelector.addEventListener('click', function() {
        // In a real app, this would open a date picker
        showToast('Calendar feature coming soon!');
      });
      
      // Dark mode toggle
      darkModeToggle.addEventListener('click', function() {
        darkMode = !darkMode;
        document.body.classList.toggle('dark-mode');
        darkModeToggle.innerHTML = darkMode ? '<i class="fas fa-sun"></i>' : '<i class="fas fa-moon"></i>';
        localStorage.setItem('darkMode', darkMode.toString());
      });
      
      // Settings button
      settingsBtn.addEventListener('click', function() {
        showToast('Settings feature coming soon!');
      });
      
      // Check for online/offline status
      window.addEventListener('online', function() {
        offlineMsg.style.display = 'none';
      });
      
      window.addEventListener('offline', function() {
        offlineMsg.style.display = 'flex';
      });
      
      // Initial check for online status
      if (!navigator.onLine) {
        offlineMsg.style.display = 'flex';
      }
      
      // Register service worker
      if ('serviceWorker' in navigator) {
        navigator.serviceWorker.register('/service-worker.js')
          .then(function(registration) {
            console.log('Service Worker registered with scope:', registration.scope);
          })
          .catch(function(error) {
            console.log('Service Worker registration failed:', error);
          });
      }
    });
  </script>
</body>
</html>